<!DOCTYPE html>
<html>
    <head>
		<style>
			*{padding:0;margin:0;min-width:0;min-height:0;font-family:Arial,Helvetica,sans-serif}html{vertical-align:middle;text-align:center}body{--background-color:#36393e;background-color:var(--background-color);min-height:100vh;min-width:100%;margin:0}button{background-color:#373a3f;color:#fff;outline:0;border-top:2px solid rgba(255,255,255,.5);border-bottom:2px solid rgba(0,0,0,.5);border-left:2px solid rgba(255,255,255,.5);border-right:2px solid rgba(0,0,0,.5)}#content,#top{padding:20px}#top{display:flex}.topButton{font-size:50px;margin:10px;padding:10px}#changeMode{margin-bottom:25px}#hint{font-size:40px;color:#fff;margin-bottom:20px}.field{background-color:#373a3f;color:#fff;font-size:20px;padding:10px;--border-color:rgb(19, 19, 19);border:2px solid var(--border-color);border-radius:7px;outline:0;transition:border .25s}.field:focus{--border-color:rgb(224, 224, 224)}.field::placeholder{color:#fff;opacity:.95}.info,.smallInfo{color:#fff;font-size:30px;margin:5px}.smallInfo{font-size:20px}#headerPart2{margin-top:20px}#activateButton{display:block;margin:0 auto;margin-top:10px;font-size:50px;padding:20px}#output{margin-top:10px;word-break:break-all}#outputHint{margin-top:20px}textarea{width:50%;min-height:100px;min-width:150px}#filePicker{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;margin-top:5px}#filePicker:not(.allowCreate) #filePickerCreate,#filePicker:not(.allowCreate) p:not(#filePickerText){display:none}#filePicker hr{visibility:hidden;width:100vw;margin-top:5px}#filePicker p,#filePickerText,.filePickerButton{font-size:20px;color:#fff}.filePickerButton{padding:10px;margin:0 10px}#fileCreator{display:none;position:absolute;top:0;bottom:0;left:0;right:0}#fileCreator div:nth-child(1){background-color:rgba(0,0,0,.5);z-index:1;position:absolute;top:0;bottom:0;left:0;right:0}#fileCreator div:nth-child(2){position:absolute;top:0;left:0;width:100%;height:100%;overflow-y:scroll;z-index:2;pointer-events:none}#fileCreator div:nth-child(2) div{position:absolute;display:flex;flex-wrap:wrap;justify-content:center;align-content:center;margin:100px auto;max-width:40%;height:fit-content;background-color:var(--background-color);border-radius:15px;padding:15px;pointer-events:all}#fileCreatorDot{color:#fff;font-size:30px;margin:0 3px;margin-top:5px}#fileCreator hr{visibility:hidden;width:100%;height:0;margin-top:10px}#fileCreator textarea{width:100%;margin:10px}#fileCreator button{font-size:30px;margin:0 5px}#clipboardCopy{padding:10px;font-size:30px;margin-top:10px;display:none}#title{object-fit:contain;width:30%;margin-bottom:25px}
		</style>

        <script>
			!function(h,c,a){var d,e="random",i=a.pow(256,6),f=a.pow(2,52),j=2*f;function b(h,b,q){var p=[];b=!0==b?{entropy:!0}:b||{};var r=g(m(b.entropy?[h,o(c)]:null==h?n():h,3),p),s=new k(p),d=function(){for(var a=s.g(6),c=i,b=0;a<f;)a=(a+b)*256,c*=256,b=s.g(1);for(;a>=j;)a/=2,c/=2,b>>>=1;return(a+b)/c};return d.int32=function(){return 0|s.g(4)},d.quick=function(){return s.g(4)/4294967296},d.double=d,g(o(s.S),c),(b.pass||q||function(b,d,f,c){return(c&&(c.S&&l(c,s),b.state=function(){return l(s,{})}),f)?(a[e]=b,d):b})(d,r,"global"in b?b.global:this==a,b.state)}function k(d){var g,e=d.length,c=this,a=0,f=c.i=c.j=0,b=c.S=[];for(e||(d=[e++]);a<256;)b[a]=a++;for(a=0;a<256;a++)b[a]=b[f=255&f+d[a%e]+(g=b[a])],b[f]=g;(c.g=function(g){for(var e,f=0,b=c.i,d=c.j,a=c.S;g--;)e=a[b=255&b+1],f=256*f+a[255&(a[b]=a[d=255&d+e])+(a[d]=e)];return c.i=b,c.j=d,f})(256)}function l(b,a){return a.i=b.i,a.j=b.j,a.S=b.S.slice(),a}function m(a,c){var d,b=[],e=typeof a;if(c&&"object"==e)for(d in a)try{b.push(m(a[d],c-1))}catch(f){}return b.length?b:"string"==e?a:a+"\0"}function g(d,b){for(var e,c=d+"",a=0;a<c.length;)b[255&a]=255&(e^=19*b[255&a])+c.charCodeAt(a++);return o(b)}function n(){try{var a;return d&&(a=d.randomBytes)?a=a(256):(a=new Uint8Array(256),(h.crypto||h.msCrypto).getRandomValues(a)),o(a)}catch(f){var b=h.navigator,e=b&&b.plugins;return[+new Date,h,e,h.screen,o(c)]}}function o(a){return String.fromCharCode.apply(0,a)}if(g(a.random(),c),"object"==typeof module&&module.exports){module.exports=b;try{d=require("crypto")}catch(p){}}else"function"==typeof define&&define.amd?define(function(){return b}):a["seed"+e]=b}("undefined"!=typeof self?self:this,[],Math)
		</script>
        <script>
			let topDiv,contentDiv,hint,hint2,activateButton,headerPart2,keyword,outputHint,input,filePicker,filePickerText,fileCreator,fileCreatorNameInput,fileCreatorExtensionInput,fileCreatorInput,output,clipboardCopy,mode,displays,usingFile;const ENCRYPTED_EXTENSION=".encrypted";let copyToClipboard=function(){let a=0;return function(){window.getSelection().removeAllRanges();let b=document.createElement("textarea");b.innerText=output.innerText,document.body.appendChild(b),b.select(),b.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(b),clipboardCopy.innerText="Copied!";let c=++a;setTimeout(function(){a===c&&(clipboardCopy.innerText="Copy to Clipboard")},3e3)}}();function clearFields(){clipboardCopy.style.display="inline",file=null}function getUsingFileFromBlob(b,c){let a=new FileReader;a.onload=a=>{filePickerText.innerText=`Using: ${c}`,usingFile={name:c,content:Array.from(new Uint8Array(a.target.result))}},a.readAsArrayBuffer(b)}function uploadFile(){let a=document.createElement("input");a.type="file";let c=displays[mode],b=c.OnlyAcceptFile;b&&(a.accept=b),a.onchange=c=>{let a=c.target.files[0];if(b&&!a.name.endsWith(b))return alert(`Invalid file type! Please make sure you upload a '${b}' file.`);getUsingFileFromBlob(a,a.name)},a.click()}function createFile(){fileCreator.style.display="block",fileCreatorNameInput.value="",fileCreatorExtensionInput.value="",fileCreatorInput.value=""}function finalizeCreateFile(c){if(c){let a=fileCreatorNameInput.value,b=fileCreatorExtensionInput.value,d=fileCreatorInput.value;if(0===a.length)return alert("Please specify a file name!");if(0===b.length)return alert("Please specify a file extension!");let e=new Blob([d]),f=a+"."+b;getUsingFileFromBlob(e,f)}fileCreator.style.display="none"}function downloadFile(f,c){let a=document.createElement("a");a.style.display="none";let d=new ArrayBuffer(c.length),g=new Uint8Array(d);for(let b=0;b<c.length;b++)g[b]=c[b];let h=new Blob([d]),e=window.URL.createObjectURL(h);a.setAttribute("href",e),a.setAttribute("download",f),a.click(),window.URL.revokeObjectURL(e)}function getTextMethods(){function a(i){let a=[];for(let b=0;b<pairing.length;b++)a.push(pairing.charAt(b));let d=[],e=[],j=new Math.seedrandom(i);for(let c=0;c<pairing.length;c++){let f=pairing[c],g=Math.floor(j()*a.length),h=a[g];a.splice(g,1),d[f]=h,e[h]=f}return{toEncrypt:d,toDecrypt:e}}function b(e,f){let b=new Math.seedrandom(e.toLowerCase()),c=[],d=[];for(let a=0;a<f;a++)c[a]={pos:b(),keyTable:Math.floor(1e3*b())/1e3,case:b()},d[a]=a;return{values:c,available:d}}return{Encrypt:function(){let g=keyword.value;if(0===g.length){alert("Enter a keyword!");return}if(0===input.value.length){alert("Enter text to encrypt!");return}let h=input.value.replaceAll(" ","_"),i=b(g,h.length),l=i.values,d=i.available,e="";for(;d.length>0;){let f=l[e.length],m=Math.floor(f.pos*d.length),j=d.splice(m,1)[0],c=h.substring(j,j+1),k=a(f.keyTable).toEncrypt;k[c]&&(c=k[c]),f.case>.3333&&(c.toUpperCase()!==c?c=c.toUpperCase():c.toLowerCase()!==c&&(c=c.toLowerCase())),e+=c}outputHint.innerText="Encrypted Message:",output.innerText=e,clearFields()},Decrypt:function(){let h=keyword.value;if(0===h.length){alert("Enter a keyword!");return}if(0===input.value.length){alert("Enter text to decrypt!");return}let f=input.value,i=b(h,f.length),l=i.values,j=i.available,e=[];for(let d=0;d<f.length;d++){let g=l[d],m=Math.floor(g.pos*j.length),n=j.splice(m,1)[0],c=f.substring(d,d+1);g.case>.3333&&(c.toLowerCase()!==c?c=c.toLowerCase():c.toUpperCase()!==c&&(c=c.toUpperCase()));let k=a(g.keyTable).toDecrypt;k[c]&&(c=k[c]),"_"===c&&(c=" "),e[n]=c}e=e.join(""),outputHint.innerText="Decrypted Message:",output.innerText=e,clearFields()}}}function getFileMethods(){function a(g,e,h){let i=new Math.seedrandom(g),c=[];for(let a=0;a<e;a++)c[a]=a;let d=[];for(let b=0;b<e;b++){let f=c.splice(Math.floor(i()*c.length),1)[0];h?d[f]=b:d[b]=f}return d}function b(c,f,g){let d=a(f,c.length,g),e=[];for(let b=0;b<d.length;b++){let h=d[b];e[h]=c[b]}return e}function c(c,e,f){let g=new Math.seedrandom(e),d=[];for(let b=0;b<c.length;b++){let h=a(g(),256,f);d.push(h[c[b]])}return d}return{Encrypt:function(){let d=keyword.value;if(0===d.length){alert("Enter a keyword!");return}if(!usingFile){alert("Please upload or create a file to encrypt!");return}let g=usingFile.content,h=usingFile.name,e=new Math.seedrandom(d),f={shift:e(),scramble:e()},a=c(g,f.shift);a=b(a,f.scramble),downloadFile(h+ENCRYPTED_EXTENSION,a)},Decrypt:function(){var k,o,l,p;let f=keyword.value;if(0===f.length){alert("Enter a keyword!");return}if(!usingFile){alert("Please upload or create a file to encrypt!");return}let m=usingFile.content,g=usingFile.name,n=g.lastIndexOf(ENCRYPTED_EXTENSION),a=g.substring(0,n),d=a.indexOf(".");if(d){let h=a.indexOf(" ",d);h>=d&&(a=a.substring(0,h))}console.log(a);let i=new Math.seedrandom(f),j={shift:i(),scramble:i()},e=b(k=m,j.scramble,!0);e=c(l=e,j.shift,!0),downloadFile(a,e)}}}function initDisplays(){let a=getTextMethods(),b=getFileMethods();displays=[{},{Title:"Encrypt a File",Hint:"Secret File \u2192 Encrypted File",Header2:"The Secret File",Hint2:"This should be the file you want to encrypt, like 'secretFile.txt'.<br>If you don't have a file, you can also enter text which will be converted into one.",ActivateButton:"Encrypt File",OnClick:b.Encrypt,InputType:"File",AllowCreate:!0},{Title:"Decrypt a File",Hint:"Encrypted File \u2192 Secret File",Header2:"The Encrypted File",Hint2:"This should be the encrypted file, like 'secretFile.txt.encrypted'.",ActivateButton:"Decrypt File",OnClick:b.Decrypt,InputType:"File",OnlyAcceptFile:ENCRYPTED_EXTENSION},{LineBreak:!0},{Title:"Encrypt a Message",Hint:"Secret Text \u2192 Y/?LGAZ*D]}",Placeholder:"Enter text to encrypt...",Header2:"The Secret Message",Hint2:"This should be the message you want to encrypt, like 'The secret base is at (-573, 338)'.",ActivateButton:"Encrypt Message",OnClick:a.Encrypt,InputType:"Text"},{Title:"Decrypt a Message",Hint:"Y/?LGAZ*D]} \u2192 Secret Text",Placeholder:"Enter text to decrypt...",Header2:"The Encrypted Message",Hint2:"This should be the encrypted message, like 'Y/?LGAZ*D]}'.",ActivateButton:"Decrypt Message",OnClick:a.Decrypt,InputType:"Text"},]}function createDisplayButtons(){for(let b=1;b<displays.length;b++){let c=displays[b];if(c.LineBreak)topDiv.appendChild(document.createElement("br"));else{let a=document.createElement("button");a.setAttribute("class","topButton"),a.setAttribute("onclick",`changeMenu(${b})`),a.innerText=c.Title;let d=document.createElement("p");d.setAttribute("class","smallInfo"),d.innerText=c.Hint,a.appendChild(d),topDiv.appendChild(a)}}}function changeMenu(b){if(output.innerText="",outputHint.innerText="",input.value="",clipboardCopy.style.display="none",mode=b,b>0){let a=displays[b];topDiv.style.display="none",contentDiv.style.display="block","Text"===a.InputType?(filePicker.style.display="none",input.style.display="",input.placeholder=a.Placeholder):"File"===a.InputType&&(filePicker.style.display="",input.style.display="none",filePickerText.innerText="No file uploaded",a.AllowCreate?filePicker.classList.add("allowCreate"):filePicker.classList.remove("allowCreate")),hint.innerHTML=a.Hint,headerPart2.innerText=a.Header2,hint2.innerHTML=a.Hint2,activateButton.innerText=a.ActivateButton,activateButton.onclick=a.OnClick}else topDiv.style.display="block",contentDiv.style.display="none"}function onLoad(){topDiv=document.getElementById("top"),contentDiv=document.getElementById("content"),hint=document.getElementById("hint"),hint2=document.getElementById("hint2"),activateButton=document.getElementById("activateButton"),headerPart2=document.getElementById("headerPart2"),keyword=document.getElementById("keyword"),input=document.getElementById("input"),filePicker=document.getElementById("filePicker"),filePickerText=document.getElementById("filePickerText"),fileCreator=document.getElementById("fileCreator"),fileCreatorNameInput=document.getElementById("fileCreatorNameInput"),fileCreatorExtensionInput=document.getElementById("fileCreatorExtensionInput"),fileCreatorInput=document.getElementById("fileCreatorInput"),output=document.getElementById("output"),outputHint=document.getElementById("outputHint"),clipboardCopy=document.getElementById("clipboardCopy"),pairing="";for(let a=33;a<=126;a++)pairing+=String.fromCharCode(a);initDisplays(),createDisplayButtons(),changeMenu(0)}
		</script>
    </head>
    <body onload="onLoad()">
        <div id="header"></div>
    
        <div id="site_container">
            <div id="site_container_container">
                <div id="body">
                    <div id="top">
                        <img style="display: none;" id="title" src="title.png"></img>
                        <!-- <br> -->
                    </div>
                    <div id="content" style="display:none">
                        <div>
                            <button id="changeMode" class="topButton" onclick="changeMenu(0)">Change Mode</button>
                            <p id="hint">Hint text</p>
                        </div>

                        <p class="info">Keyword</p>
                        <input id="keyword" class="field" type="text" placeholder="Enter keyword...">
                        <p class="smallInfo">A keyword is used to encrypt and decrypt. It's like a password to translate between encrypted and decrypted information.</p>
                        
                        <p id="headerPart2" class="info">The Text</p>
                        <p id="hint2" class="smallInfo">Helpful info here</p>
                        <textarea id="input" class="field" placeholder="To exist... or to not exist, that is the question."></textarea>
                        <div id="filePicker">
                            <button id="filePickerUpload" class="filePickerButton" onclick="uploadFile()">Upload File</button>
                            <p>or</p>
                            <button id="filePickerCreate" class="filePickerButton" onclick="createFile()">Create File</button>
                            <hr>
                            <p id="filePickerText"></p>
                        </div>
                        <div id="fileCreator">
                            <div onclick="finalizeCreateFile(false)"></div>
                            <div>
                                <div>
                                    <p class="info">File Name & Extension</p>
                                    <p class="smallInfo">To create a file, choose a file name (like file) and an extension (like txt).</p>
                                    <hr>
                                    <input id="fileCreatorNameInput" class="field" type="text" placeholder="Enter file name...">
                                    <p id="fileCreatorDot">.</p>
                                    <input id="fileCreatorExtensionInput" class="field" type="text" placeholder="Enter file extension...">
                                    <hr>
                                    <p class="info">Contents</p>
                                    <p class="smallInfo">Then, enter the contents of your new file, like 'The secret base is at (1, 2)'.<br>When you're finished, simply press the 'Create File' button.</p>
                                    <textarea id="fileCreatorInput" class="field" placeholder="Enter contents of the file..."></textarea>
                                    <hr>
                                    <button onclick="finalizeCreateFile(true)">Create File</button>
                                    <button onclick="finalizeCreateFile(false)">Cancel</button>
                                </div>
                            </div>
                        </div>
                        <button id="activateButton">Do Stuff!</button>
                        <p id="outputHint" class="info"></p>
                        <p id="output" class="smallInfo"></p>
                        <button id="clipboardCopy" onclick="copyToClipboard()">Copy To Clipboard</button>
                    </div>
                </div>
        
                <div id="footer"></div>
            </div>
        </div>
    </body>
</html>